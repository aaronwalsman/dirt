/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/ops/scatter.py:92: FutureWarning: scatter inputs have incompatible types: cannot safely cast value from dtype=int64 to dtype=int32 with jax_numpy_dtype_promotion='standard'. In future JAX releases this will result in an error.
  warnings.warn(
Traceback (most recent call last):
  File "/n/holylfs06/LABS/sham_lab/Users/chloe00/dirt/dirt/examples/nomnom/train_nomnom.py", line 127, in <module>
    train(key, params)
  File "/n/holylfs06/LABS/sham_lab/Users/chloe00/dirt/dirt/examples/nomnom/train_nomnom.py", line 62, in train
    train_state, active_players = reset_train(reset_key)
                                  ^^^^^^^^^^^^^^^^^^^^^^
  File "/n/holylfs06/LABS/sham_lab/Users/chloe00/mechagogue/mechagogue/pop/natural_selection.py", line 72, in init
    model_state = init_model_state(model_keys)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/traceback_util.py", line 180, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/api.py", line 992, in vmap_f
    out_flat = batching.batch(
               ^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/linear_util.py", line 193, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/holylfs06/LABS/sham_lab/Users/chloe00/mechagogue/mechagogue/arg_wrappers.py", line 26, in wrapped_function
    return function(**wrapped_args)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/holylfs06/LABS/sham_lab/Users/chloe00/mechagogue/mechagogue/nn/sequence.py", line 27, in init
    layer_keys = jrng.split(key, num_layers)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/random.py", line 293, in split
    return _return_prng_keys(wrapped, _split(typed_key, num))
                                      ^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/random.py", line 279, in _split
    return prng.random_split(key, shape=shape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/prng.py", line 566, in random_split
    return random_split_p.bind(keys, shape=shape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/core.py", line 438, in bind
    return self.bind_with_trace(find_top_trace(args), args, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/core.py", line 442, in bind_with_trace
    out = trace.process_primitive(self, map(trace.full_raise, args), params)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/interpreters/batching.py", line 491, in process_primitive
    val_out, dim_out = batched_primitive(vals_in, dims_in, **params)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/interpreters/batching.py", line 1041, in vectorized_batcher
    return prim.bind(*batched_args, **params), batch_dims[0]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/core.py", line 438, in bind
    return self.bind_with_trace(find_top_trace(args), args, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/core.py", line 442, in bind_with_trace
    out = trace.process_primitive(self, map(trace.full_raise, args), params)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/core.py", line 955, in process_primitive
    return primitive.impl(*tracers, **params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/prng.py", line 578, in random_split_impl
    base_arr = random_split_impl_base(
               ^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/prng.py", line 584, in random_split_impl_base
    return split(base_arr)
           ^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/traceback_util.py", line 180, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/api.py", line 992, in vmap_f
    out_flat = batching.batch(
               ^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/linear_util.py", line 193, in call_wrapped
    ans = self.f(*args, **dict(self.params, **kwargs))
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/prng.py", line 583, in <lambda>
    split = iterated_vmap_unary(keys_ndim, lambda k: impl.split(k, shape))
                                                     ^^^^^^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/prng.py", line 1087, in threefry_split
    return _threefry_split(key, shape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/traceback_util.py", line 180, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/pjit.py", line 338, in cache_miss
    outs, out_flat, out_tree, args_flat, jaxpr, attrs_tracked = _python_pjit_helper(
                                                                ^^^^^^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/pjit.py", line 188, in _python_pjit_helper
    out_flat = pjit_p.bind(*args_flat, **p.params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/core.py", line 2803, in bind
    return self.bind_with_trace(top_trace, args, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/core.py", line 442, in bind_with_trace
    out = trace.process_primitive(self, map(trace.full_raise, args), params)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/interpreters/batching.py", line 491, in process_primitive
    val_out, dim_out = batched_primitive(vals_in, dims_in, **params)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/pjit.py", line 1970, in _pjit_batcher
    vals_out = pjit_p.bind(
               ^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/core.py", line 2803, in bind
    return self.bind_with_trace(top_trace, args, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/core.py", line 442, in bind_with_trace
    out = trace.process_primitive(self, map(trace.full_raise, args), params)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/core.py", line 955, in process_primitive
    return primitive.impl(*tracers, **params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/pjit.py", line 1738, in _pjit_call_impl
    return xc._xla.pjit(
           ^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/pjit.py", line 1714, in call_impl_cache_miss
    out_flat, compiled = _pjit_call_impl_python(
                         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/pjit.py", line 1644, in _pjit_call_impl_python
    ).compile(compile_options)
      ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/interpreters/pxla.py", line 2345, in compile
    executable = UnloadedMeshExecutable.from_hlo(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/interpreters/pxla.py", line 2854, in from_hlo
    xla_executable = _cached_compilation(
                     ^^^^^^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/interpreters/pxla.py", line 2666, in _cached_compilation
    xla_executable = compiler.compile_or_get_cached(
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/compiler.py", line 434, in compile_or_get_cached
    return _compile_and_write_cache(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/compiler.py", line 662, in _compile_and_write_cache
    executable = backend_compile(
                 ^^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/profiler.py", line 333, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/compiler.py", line 267, in backend_compile
    return backend.compile(built_c, compile_options=options)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
