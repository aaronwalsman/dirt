/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/ops/scatter.py:92: FutureWarning: scatter inputs have incompatible types: cannot safely cast value from dtype=int64 to dtype=int32 with jax_numpy_dtype_promotion='standard'. In future JAX releases this will result in an error.
  warnings.warn(
Population: 32, Food: 29
actions NomNomAction(forward=Traced<ShapedArray(int64[256])>with<DynamicJaxprTrace(level=2/0)>, rotate=Traced<ShapedArray(int64[256])>with<DynamicJaxprTrace(level=2/0)>, reproduce=Traced<ShapedArray(int64[256])>with<DynamicJaxprTrace(level=2/0)>)
> /n/holylfs06/LABS/sham_lab/Users/chloe00/mechagogue/mechagogue/pop/natural_selection.py(89)step()
-> wandb.log(actions, step=state)
NomNomAction(forward=Traced<ShapedArray(int64[256])>with<DynamicJaxprTrace(level=2/0)>, rotate=Traced<ShapedArray(int64[256])>with<DynamicJaxprTrace(level=2/0)>, reproduce=Traced<ShapedArray(int64[256])>with<DynamicJaxprTrace(level=2/0)>)
Traced<ShapedArray(int64[256])>with<DynamicJaxprTrace(level=2/0)>
*** jax.errors.ConcretizationTypeError: Abstract tracer value encountered where concrete value is expected: traced array with shape int64[256]
The tolist() method was called on traced array with shape int64[256].
The error occurred while tracing the function scan_body at /n/holylfs06/LABS/sham_lab/Users/chloe00/dirt/dirt/examples/nomnom/train_nomnom.py:66 for scan. This concrete value was not available in Python because it depends on the values of the arguments train_state_active[0][<flat index 1>][<flat index 0>], train_state_active[0][<flat index 1>][<flat index 1>], train_state_active[0][<flat index 2>][0][1]['energy'][1][0][0], train_state_active[0][<flat index 2>][0][1]['energy'][1][2][0], train_state_active[0][<flat index 2>][0][1]['view'][0], train_state_active[0][<flat index 2>][0][1]['view'][1][0], train_state_active[0][<flat index 2>][0][1]['view'][3][0], train_state_active[0][<flat index 2>][0][1]['view'][6][0], train_state_active[0][<flat index 2>][1][0][0], train_state_active[0][<flat index 2>][1][2][0], train_state_active[0][<flat index 2>][2][0]['forward'][0][0], and step_key.
The error occurred while tracing the function scan_body at /n/holylfs06/LABS/sham_lab/Users/chloe00/dirt/dirt/examples/nomnom/train_nomnom.py:66 for scan. This concrete value was not available in Python because it depends on the values of the arguments train_state_active[0][<flat index 1>][<flat index 0>], train_state_active[0][<flat index 1>][<flat index 1>], train_state_active[0][<flat index 2>][0][1]['energy'][1][0][0], train_state_active[0][<flat index 2>][0][1]['energy'][1][2][0], train_state_active[0][<flat index 2>][0][1]['view'][0], train_state_active[0][<flat index 2>][0][1]['view'][1][0], train_state_active[0][<flat index 2>][0][1]['view'][3][0], train_state_active[0][<flat index 2>][0][1]['view'][6][0], train_state_active[0][<flat index 2>][1][0][0], train_state_active[0][<flat index 2>][1][2][0], train_state_active[0][<flat index 2>][2][0]['forward'][0][0], and step_key.

See https://jax.readthedocs.io/en/latest/errors.html#jax.errors.ConcretizationTypeError
Traced<ShapedArray(int64[256])>with<DynamicJaxprTrace(level=2/0)>
*** NameError: name 'np' is not defined
*** jax.errors.TracerArrayConversionError: The numpy.ndarray conversion method __array__() was called on traced array with shape int64[256]
The error occurred while tracing the function scan_body at /n/holylfs06/LABS/sham_lab/Users/chloe00/dirt/dirt/examples/nomnom/train_nomnom.py:66 for scan. This concrete value was not available in Python because it depends on the values of the arguments train_state_active[0][<flat index 1>][<flat index 0>], train_state_active[0][<flat index 1>][<flat index 1>], train_state_active[0][<flat index 2>][0][1]['energy'][1][0][0], train_state_active[0][<flat index 2>][0][1]['energy'][1][2][0], train_state_active[0][<flat index 2>][0][1]['view'][0], train_state_active[0][<flat index 2>][0][1]['view'][1][0], train_state_active[0][<flat index 2>][0][1]['view'][3][0], train_state_active[0][<flat index 2>][0][1]['view'][6][0], train_state_active[0][<flat index 2>][1][0][0], train_state_active[0][<flat index 2>][1][2][0], train_state_active[0][<flat index 2>][2][0]['forward'][0][0], and step_key.
See https://jax.readthedocs.io/en/latest/errors.html#jax.errors.TracerArrayConversionError
